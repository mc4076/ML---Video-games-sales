---
title: "Video Games Sales Prediction"
author: "Minh K. Chau"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

## About the Dataset

I like video games. In this project, I will use a data set obtained from **Kaggle**, a data science community, to generate an algorithm to predict sales of video games in North America (NA), Europe (EU), Japan (JP), and other countries. According to Kaggle, this dataset was generated by a scrape of **vgchartz.com**.

The dataset includes the following variables:

-   **Rank -** ranking of overall sales

-   **Name** - The games name

-   **Platform** - Platform of the games release (i.e. PC,PS4, etc.)

-   **Year** - Year of the game's release

-   **Genre** - Genre of the game

-   **Publisher** - Publisher of the game

-   **NA_Sales** - Sales in North America (in millions)

-   **EU_Sales** - Sales in Europe (in millions)

-   **JP_Sales** - Sales in Japan (in millions)

-   **Other_Sales** - Sales in the rest of the world (in millions)

-   **Global_Sales** - Total worldwide sales.

The data set contains 16,598 rows in-total.

## Packages, Read-in Files, and Settings

For this project, the following packages were used:

-   **Tidyverse -** for data wrangling, transformation, and plotting

-   **Caret -** to develop a Machine Learning algorithm

-   **ggpubr -** to combine multiple plots into one

-   **Randomforest** - generate an algorithm using Random Forest approach

Seed will be set at 5 for consistency in results and write-up. Numerical outputs will be rounded up to 3 digits after the decimal place.

The dataset was renamed as **Orig (original).**

```{r,message=FALSE,warning=FALSE}
#---------------Library & Read-in Files----------------
library(tidyverse)
library(caret)
library(ggpubr)
library(randomForest)

setwd("C:/Users/minhk/OneDrive/Data Science stuffs/PORTFOLIO/ML - Video games sales")
orig <- read.csv("vgsales.csv")

options(digits = 3)
set.seed(5)
```

# Methods

## Data Exploration & Transformation

### Year

```{r}
range(orig$Year)
length(unique(orig$Year))
```

The "Year" variable has a range between 1980 - NA, with about 40 unique values. This indicates a presence of an unknown values. Data transformation is conducted, transforming years in numerical values into categorical ones, using the following rule:

| From | To                 | Category |
|------|--------------------|----------|
| 1980 | 1984               | 1980s    |
| 1985 | 1989               | 1985s    |
| 1990 | 1994               | 1990s    |
| 1995 | 1999               | 1995s    |
| 2000 | 2004               | 2000s    |
| 2005 | 2009               | 2005s    |
| 2010 | 2014               | 2010s    |
| 2015 | 2020               | 2015s    |
|      | Missing or unknown | unknown  |

: Table 1. Rule for transforming years into Years.ranged

```{r,warning = FALSE}
# Transform individual Years to Yr-Released 
orig <- orig %>%
  mutate(Year = as.numeric(Year),
         yr.released = ifelse(Year < 1985, "1980s",
                       ifelse(Year >=1985 & Year <1990,"1985s",
                       ifelse(Year >=1990 & Year <1995,"1990s",
                       ifelse(Year >=1995 & Year <2000,"1995s",
                       ifelse(Year >=2000 & Year <2005,"2000s",
                       ifelse(Year >=2005 & Year <2010,"2005s",
                       ifelse(Year >=2010 & Year <2015,"2010s",
                       ifelse(Year >=2015 & Year <=2020,"2015s","N/A")))))))))

orig <- orig %>%
  mutate(yr.released = ifelse(is.na(yr.released) == TRUE,"unknown",yr.released))

orig %>%
  group_by(yr.released) %>%
  count()
```

The above tibble showed the number of rows by different groups of Years released.

### Publishers

I first explored about all different Publishers, and their global sales in total.

```{r}
length(unique(orig$Publisher))
```

There are about 579 unique Publishers.

```{r}
orig %>%
  select(Global_Sales,
         Publisher) %>%
  group_by(Publisher) %>%
  summarise(Total.sales = sum(Global_Sales)) %>%
  arrange(desc(Total.sales)) %>%
  head(50) %>%
  data.frame()
```

Per the table above, there are some publishers that sold a lot of video games while others were not as popular. For this variable, I grouped publishers into categories based on their total global sales. The rules are as followed:

| Publishers                                                                                  | Ranking |
|---------------------------------------------------------------------------------------------|---------|
| Nintendo, Electronic Arts, Activision, Sony Computer Entertainment, Ubisoft                 | top-5   |
| Take-Two Interactive, THQ, Konami Digital Entertainment, Sega, Namco Bandai Games           | top-10  |
| Microsoft Game Studios, Capcom, Atari, Warner Bros. Interactive Entertainment, Squared Enix | top-15  |
| Disney Interactive Studios, Elidos Interactive, LucasArts, Bethesda Softworks, Midway Games | top-20  |
| Acclaim Entertainment, Vivendi Games, SquareSoft, 505 Games, Tecmo Koei                     | top-25  |
| Codemasters, Virgin Interactive, Enix Corporation, Deep Silver, GT Interactive              | top-30  |
| all other publishers                                                                        | other   |

: Publishers & their Rank

```{r}
orig <- orig %>%
  mutate(publisher.rank = ifelse(Publisher == "Nintendo","top-5",
                          ifelse(Publisher == "Electronic Arts","top-5",
                          ifelse(Publisher == "Activision","top-5",
                          ifelse(Publisher == "Sony Computer Entertainment","top-5",
                          ifelse(Publisher == "Ubisoft","top-5",
                          ifelse(Publisher == "Take-Two Interactive","top-10",
                          ifelse(Publisher == "THQ","top-10",       
                          ifelse(Publisher == "Konami Digital Entertainment","top-10",
                          ifelse(Publisher == "Sega","top-10",
                          ifelse(Publisher == "Namco Bandai Games","top-10",
                          ifelse(Publisher == "Microsoft Game Studios","top-15",
                          ifelse(Publisher == "Capcom","top-15",
                          ifelse(Publisher == "Atari","top-15",
                          ifelse(Publisher == "Warner Bros. Interactive Entertainment","top-15",
                          ifelse(Publisher == "Square Enix","top-15",
                          ifelse(Publisher == "Disney Interactive Studios","top-20",
                          ifelse(Publisher == "Eidos Interactive","top-20",       
                          ifelse(Publisher == "LucasArts","top-20",
                          ifelse(Publisher == "Bethesda Softworks","top-20",
                          ifelse(Publisher == "Midway Games","top-20", 
                          ifelse(Publisher == "Acclaim Entertainment","top-25",
                          ifelse(Publisher == "Vivendi Games","top-25",
                          ifelse(Publisher == "SquareSoft","top-25",
                          ifelse(Publisher == "505 Games","top-25",
                          ifelse(Publisher == "Tecmo Koei","top-25",
                          ifelse(Publisher == "Codemasters","top-30",
                          ifelse(Publisher == "Virgin Interactive","top-30",
                          ifelse(Publisher == "Enix Corporation","top-30",
                          ifelse(Publisher == "Deep Silver","top-30",
                          ifelse(Publisher == "GT Interactive","top-30","other")
                          ))))))))))))))))))))))))))))))

orig %>%
  group_by(publisher.rank) %>%
  summarise(Total.sales = sum(Global_Sales),
            n = n(),
            mean.sales = mean(Global_Sales)) %>%
  arrange(desc(mean.sales))
```

Per the table above, publishers were ranked according to global sales and their mean sales.

### Platforms

```{r}
length(unique(orig$Platform))
```

There are 31 different platforms. I proceeded to compare them by their Global Sales.

```{r}
orig %>%
  group_by(Platform) %>%
  summarise(n = n(),
            mean = mean(Global_Sales),
            sum = sum(Global_Sales))%>%
  arrange(desc(sum)) %>%
  print(n = 32)
```

With the sum of global sales less than 2 millions for SCD, NG, WS, TG16, 3DO, GG, PCFX, I decided that they are not popular platforms. I will rename those platforms into "Not-Popular."

```{r}
# the last platforms are very low => rename them to other
orig <- orig %>%
  mutate(Platform = ifelse(Platform == "SCD","Not-Popular",
                    ifelse(Platform == "NG","Not-Popular",
                    ifelse(Platform == "WS","Not-Popular",
                    ifelse(Platform == "TG16","Not-Popular",
                    ifelse(Platform == "3DO","Not-Popular",
                    ifelse(Platform == "GG","Not-Popular",
                    ifelse(Platform == "PCFX","Not-Popular",Platform))))))))

orig %>%
  group_by(Platform) %>%
  summarise(n = n(),
            mean = mean(Global_Sales),
            sum = sum(Global_Sales))%>%
  arrange(desc(sum)) %>%
  print(n = 32)
```

### Genres

```{r}
unique(orig$Genre)              
sum(is.na(orig$Genre))
```

There is no missing data for gaming genres. There are 12 genres in total.

```{r}
orig %>%
  group_by(Genre) %>%
  summarise(n = n(),
            mean = mean(Global_Sales),
            sum = sum(Global_Sales))%>%
  arrange(desc(sum)) %>%
  print(n = 12)
```

The tibble above indicates that some genres are more likely to have more sales while there are some that are not.

## Data Visualization

### Individual Plots

The following code chunk makes individual barplots of each of the following sales by ***platforms, released year, genre, publishers, top-10 publishers***

-   Global

-   North America

-   Europe

-   Japan

-   Other Countries

```{r}
#----Global sales
# by Platforms 
glo.plat <- orig %>%
  select(Global_Sales,
         Platform) %>%
  group_by(Platform) %>%
  summarise(sum = sum(Global_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Platform,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Global")

# by Released Year
glo.yr <- orig %>%
  select(Global_Sales,
         yr.released) %>%
  group_by(yr.released) %>%
  summarise(sum = sum(Global_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = yr.released,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(yr.released,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Global")

# by Genre
glo.genres <- orig %>%
  select(Global_Sales,
         Genre) %>%
  group_by(Genre) %>%
  summarise(sum = sum(Global_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Genre,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Genre,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Global")

# by Publishers
glo.pub <- orig %>%
  select(Global_Sales,
         publisher.rank) %>%
  group_by(publisher.rank) %>%
  summarise(sum = sum(Global_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = publisher.rank,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(publisher.rank,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Global")

# by top 10 publishers
glo.pus <- orig %>%
  select(Global_Sales,
         Publisher) %>%
  group_by(Publisher) %>%
  summarise(sum = sum(Global_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Publisher,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Global")

#----North America sales
# NA sales by Platforms 
na.plat <- orig %>%
  select(NA_Sales,
         Platform) %>%
  group_by(Platform) %>%
  summarise(sum = sum(NA_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Platform, sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("North America")

# NA Sales by Released Year
na.yr <- orig %>%
  select(NA_Sales,
         yr.released) %>%
  group_by(yr.released) %>%
  summarise(sum = sum(NA_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = yr.released,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(yr.released,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("North America")

# NA sales by Genre
na.genres <- orig %>%
  select(NA_Sales,
         Genre) %>%
  group_by(Genre) %>%
  summarise(sum = sum(NA_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Genre,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Genre,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("North America")

# by Publishers
na.pub <- orig %>%
  select(NA_Sales,
         publisher.rank) %>%
  group_by(publisher.rank) %>%
  summarise(sum = sum(NA_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = publisher.rank,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(publisher.rank,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("North America")

# by top 10 publishers
na.pus <- orig %>%
  select(NA_Sales,
         Publisher) %>%
  group_by(Publisher) %>%
  summarise(sum = sum(NA_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Publisher,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("North America")

#----European sales
# Europe sales by Platforms 
eu.plat <- orig %>%
  select(EU_Sales,
         Platform) %>%
  group_by(Platform) %>%
  summarise(sum = sum(EU_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Platform, sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Europe")

# EU Sales by Released Year
eu.yr <- orig %>%
  select(EU_Sales,
         yr.released) %>%
  group_by(yr.released) %>%
  summarise(sum = sum(EU_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = yr.released,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(yr.released,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Europe")

# EU sales by Genre
eu.genres <- orig %>%
  select(EU_Sales,
         Genre) %>%
  group_by(Genre) %>%
  summarise(sum = sum(EU_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Genre,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Genre,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Europe") 

# by Publishers
eu.pub <- orig %>%
  select(EU_Sales,
         publisher.rank) %>%
  group_by(publisher.rank) %>%
  summarise(sum = sum(EU_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = publisher.rank,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(publisher.rank,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Europe")

# by top 10 publishers
eu.pus <- orig %>%
  select(EU_Sales,
         Publisher) %>%
  group_by(Publisher) %>%
  summarise(sum = sum(EU_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Publisher,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Europe")

#----Japanese Sales
# Japan sales by Platforms 
jp.plat <- orig %>%
  select(JP_Sales,
         Platform) %>%
  group_by(Platform) %>%
  summarise(sum = sum(JP_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Platform, sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Japan")

# JP Sales by Released Year
jp.yr <- orig %>%
  select(JP_Sales,
         yr.released) %>%
  group_by(yr.released) %>%
  summarise(sum = sum(JP_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = yr.released,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(yr.released,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Japan")

# JP sales by Genre
jp.genres <- orig %>%
  select(JP_Sales,
         Genre) %>%
  group_by(Genre) %>%
  summarise(sum = sum(JP_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Genre,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Genre,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Japan")

# by Publishers
jp.pub <- orig %>%
  select(JP_Sales,
         publisher.rank) %>%
  group_by(publisher.rank) %>%
  summarise(sum = sum(JP_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = publisher.rank,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(publisher.rank,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Japan")

# by top 10 publishers
jp.pus <- orig %>%
  select(JP_Sales,
         Publisher) %>%
  group_by(Publisher) %>%
  summarise(sum = sum(JP_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Publisher,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Japan")

#----Other Country Sales
# Other countries sales by Platforms 
other.plat <- orig %>%
  select(Other_Sales,
         Platform) %>%
  group_by(Platform) %>%
  summarise(sum = sum(Other_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Platform, sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Other Countries") 

#---
# other Sales by Released Year
other.yr <- orig %>%
  select(Other_Sales,
         yr.released) %>%
  group_by(yr.released) %>%
  summarise(sum = sum(Other_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = yr.released,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(yr.released,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Other Countries") 

# other sales by Genre
other.genres <- orig %>%
  select(Other_Sales,
         Genre) %>%
  group_by(Genre) %>%
  summarise(sum = sum(Other_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Genre,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Genre,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Other Countries") 

# by Publishers
other.pub <- orig %>%
  select(Other_Sales,
         publisher.rank) %>%
  group_by(publisher.rank) %>%
  summarise(sum = sum(Other_Sales)) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = publisher.rank,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(publisher.rank,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Other Countries")

# by top 10 publishers
other.pus <- orig %>%
  select(Other_Sales,
         Publisher) %>%
  group_by(Publisher) %>%
  summarise(sum = sum(Other_Sales)) %>%
  arrange(desc(sum)) %>%
  head(10) %>%
  data.frame() %>%
  ggplot(aes(x = sum,
             y = Platform,
             fill = -sum)) +
  geom_bar(mapping = aes(x= sum,
                         y= reorder(Publisher,sum)),
           stat = "identity",
           width = 0.5,
           position = "dodge") +
  theme_minimal() +
  theme(axis.title.y = element_blank(),
        legend.position = "none") +
  xlab("Other Countries")
```

### Comparing Sales by Platforms

```{r}
ggarrange(na.plat,
          eu.plat,
          jp.plat,
          other.plat,
          glo.plat,
          legend.grob = NULL,
          legend = NULL) %>%
  annotate_figure(top = text_grob("Total Video Game Sales (in millions) by Platforms",
                                  color = "black",
                                  face = "bold",
                                  size = 14))
```

The plot above combine plots from different individual countries and compare them by Platforms. By sorting them in a descending order, I concluded that each country have different preference in gaming platforms. For example:

-   NA: X360, PS2, Wii

-   EU: PS3, PS2, X360

-   Japan: DS, PS, Ps2

-   Other countries: PS2, PS3, X360

But also, looking at the different scales, I can conclude that some countries buy more games than other. For example, NA buys more games than any other countries, followed by Europe, other countries, and then Japan. This is attributed to different population size or it can be different demands as well.

### Comparing Sales by Released Years

```{r}
# -----Released Years -----
ggarrange(na.yr,
          eu.yr,
          jp.yr,
          other.yr,
          glo.yr,
          legend = NULL) %>%
  annotate_figure(top = text_grob("Total Video Game Sales (in millions) by Released Years",
                                  color = "black",
                                  face = "bold",
                                  size = 14))
```

Per the plot above, regardless of countries, video games released in the 2005s, 2010s, and 2000s were bought more than those released in any other years.

### Comparing Sales by Video Games Genres

```{r}
# --------------Genres ------------------
ggarrange(na.genres,
          eu.genres,
          jp.genres,
          other.genres,
          glo.genres,
          legend = NULL) %>%
  annotate_figure(top = text_grob("Total Video Game Sales (in millions) by Genres",
                                  color = "black",
                                  face = "bold",
                                  size = 14))
```

Per the figure above, there is a consistent pattern in Genres popularity. Action, Sport, and Shooter remained popular among all countries except Japan. Japan's number one genre is Role-Playing Games.

### Comparing Sales by Publisher Rank

```{r}
ggarrange(na.pub,
          eu.pub,
          jp.pub,
          other.pub,
          glo.pub,
          legend = NULL) %>%
  annotate_figure(top = text_grob("Total Video Game Sales (in millions) by Publisher Rank",
                                  color = "black",
                                  face = "bold",
                                  size = 14))
```

In regard to Publisher ranks, the pattern remain consistent across countries.

### Comparing Sales by Top-10 Publishers

```{r}
ggarrange(na.pus,
          eu.pus,
          jp.pus,
          other.pus,
          glo.pus,
          legend = NULL) %>%
  annotate_figure(top = text_grob("Total Video Game Sales (in millions) by Top-10 Publishers",
                                  color = "black",
                                  face = "bold",
                                  size = 14))
```

There is a difference in preference between countries Although Nintendo remains popular among all countries, Japan preferred their country's publisher more (e.g., Namco Bandai Games, Konami Digital Entertainment) while other countries prefers Electronic Arts.

## Preparing Train & Test Set

To develop the algorithm, I will split the Original data set into two parts:

**Train set:** contains 70% of data from the original.

**Test set:** contains 30% of data from the original

Both the train & Test set are splitted by Global Sales. They only have the following variables:

-   Predictors: Released Year, Publisher Rank, Genre, and Platform

-   Outcome: NA sales, JP Sales, EU Sales, Other Countries Sales

I will develop different algorithm for each sales because global sales are just a sum of all sales. I came to this conclusion because due to the graph above, we can see a different patterns in sales from each countries using different predictors.

```{r,warning=FALSE}
# Train index
train.index <- createDataPartition(orig$Global_Sales,
                                   times = 1,
                                   p = .7,
                                   list = FALSE)

# Train set
train.set <- orig %>%
  slice(train.index) %>%
  select(!c(Rank,
            Name,
            Year,
            Publisher)) %>%
  mutate(Platform = factor(Platform),
         Genre = factor(Genre),
         yr.released = factor(yr.released),
         publisher.rank = factor(publisher.rank))

# test set
test.set <- orig %>%
  slice(-train.index) %>%
  select(!c(Rank,
            Name,
            Year,
            Publisher)) %>%
  mutate(Platform = factor(Platform),
         Genre = factor(Genre),
         yr.released = factor(yr.released),
         publisher.rank = factor(publisher.rank))
```

It is necessary to check the level (of predictors) between the Train set and the test set because if the two sets have different levels in their predictors, the algorithm would not run.

### Platforms

```{r}
# predictors level Checking between train vs. test
levels(factor(train.set$Platform))
levels(factor(test.set$Platform))         # have same levels
```

### Genres

```{r}
levels(factor(train.set$Genre))
levels(factor(test.set$Genre))    # same levels
```

### Released Year

```{r}
levels(factor(train.set$yr.released))
levels(factor(test.set$yr.released)) 
```

### Publisher Rank

```{r}
levels(factor(train.set$publisher.rank))
levels(factor(test.set$publisher.rank)) 
```

All predictors between the two sets have the same levels. Proceed to developing algorithms.

## The Algorithms

Two algorithm will be developed using different methods: **Generalized Linear Model (GLM) & Random Forest (RF).** The purpose of the algorithm is predicting scores (i.e., predicting a continuous value), so these two methods are suitable.

For Random Forest, the algorithm will perform calculation of about 50 trees (i.e., to avoid long computation time and it is recommended that trees are stable about 48 - 162), and the tree with the best outcome will be used as the algorithm. I will then compare the ***Root Mean Squared Error (RMSE)*** between the two algorithm and pick the one with the lowest RMSE.

This same procedure will applied for all four Sales: NA, EU, JP, and Other Countries.

### North America

```{r}
# GLM model 
NA.fit_glm <- train(data = train.set,
                    NA_Sales~Platform + Genre + yr.released + publisher.rank,
                    method = "glm")

NA.y_hat_glm <- predict(NA.fit_glm,test.set)

# Random Forest Model 
NA.train_forest <- train(data = train.set,
                         NA_Sales~Platform + Genre + 
                      yr.released + publisher.rank,
                    method = "rf",
                    tuneGrid = data.frame(mtry = seq(1:7)),
                    ntree = 50)

NA.fit_forest <- randomForest(NA_Sales~Platform + Genre + 
                                yr.released + publisher.rank,
                       data = train.set,
                       minNode = NA.train_forest$bestTune$mtry)
NA.y_hat_forest <- predict(NA.fit_forest,test.set)

# RMSE
data.frame(GLM = mean((NA.y_hat_glm - test.set$NA_Sales)^2),
           Random.Forest = mean((NA.y_hat_forest - test.set$NA_Sales)^2))
```

### Europe

```{r}
# GLM model 
EU.fit_glm <- train(data = train.set,
                    EU_Sales~Platform + Genre + yr.released + publisher.rank,
                    method = "glm")

EU.y_hat_glm <- predict(EU.fit_glm,test.set)

# Random Forest Model 
EU.train_forest <- train(data = train.set,
                         EU_Sales~Platform + Genre + 
                           yr.released + publisher.rank,
                         method = "rf",
                         tuneGrid = data.frame(mtry = seq(1:7)),
                         ntree = 50)

EU.fit_forest <- randomForest(EU_Sales~Platform + Genre + 
                                yr.released + publisher.rank,
                              data = train.set,
                              minNode = EU.train_forest$bestTune$mtry)

EU.y_hat_forest <- predict(EU.fit_forest,test.set)

# RMSE
data.frame(GLM = mean((EU.y_hat_glm - test.set$EU_Sales)^2),
           Random.Forest = mean((EU.y_hat_forest - test.set$EU_Sales)^2))
```

### Japan

```{r}
# GLM model 
JP.fit_glm <- train(data = train.set,
                    JP_Sales~Platform + Genre + yr.released + publisher.rank,
                    method = "glm")

JP.y_hat_glm <- predict(JP.fit_glm,test.set)

# Random Forest Model 
JP.train_forest <- train(data = train.set,
                         JP_Sales~Platform + Genre + 
                           yr.released + publisher.rank,
                         method = "rf",
                         tuneGrid = data.frame(mtry = seq(1:7)),
                         ntree = 50)

JP.fit_forest <- randomForest(JP_Sales~Platform + Genre + 
                                yr.released + publisher.rank,
                              data = train.set,
                              minNode = JP.train_forest$bestTune$mtry)

JP.y_hat_forest <- predict(JP.fit_forest,test.set)

# RMSE
data.frame(GLM = mean((JP.y_hat_glm - test.set$JP_Sales)^2),
           Random.Forest = mean((JP.y_hat_forest - test.set$JP_Sales)^2))
```

### Other Countries

```{r}
# GLM model 
Other.fit_glm <- train(data = train.set,
                    Other_Sales~Platform + Genre + yr.released + publisher.rank,
                    method = "glm")

Other.y_hat_glm <- predict(Other.fit_glm,test.set)

# Random Forest Model 
Other.train_forest <- train(data = train.set,
                         Other_Sales ~ Platform + Genre + 
                           yr.released + publisher.rank,
                         method = "rf",
                         tuneGrid = data.frame(mtry = seq(1:7)),
                         ntree = 50)

Other.fit_forest <- randomForest(Other_Sales~Platform + Genre + 
                                yr.released + publisher.rank,
                                data = train.set,
                                minNode = Other.train_forest$bestTune$mtry)

Other.y_hat_forest <- predict(Other.fit_forest,
                              test.set)

# RMSE
data.frame(GLM = mean((Other.y_hat_glm - test.set$Other_Sales)^2),
           Random.Forest = mean((Other.y_hat_forest - test.set$Other_Sales)^2))
```

# Results.

Using GLM and Random Forest methods, two algorithms were established to predict sales by video games genres, publisher ranks, platforms, and released years for North America, Europe, Japan, and Other Countries. Comparing between the GLM and Random Forest method, Random Forest yields a lower RMSE in overall. Hence, **I will choose algorithm generated by Random Forest method.**

### RMSE table for Random Forest Method

```{r}
# RMSE Table: Random Forest Method
data.frame(North.America = mean((NA.y_hat_forest - test.set$NA_Sales)^2),
           Europe = mean((EU.y_hat_forest - test.set$EU_Sales)^2),
           Japan = mean((JP.y_hat_forest - test.set$JP_Sales)^2),
           Other.Countries = mean((Other.y_hat_forest - test.set$Other_Sales)^2))
```

### RMSE table for GLM method

```{r}
# RMSE Table: GLM Method
data.frame(North.America = mean((NA.y_hat_glm - test.set$NA_Sales)^2),
           Europe = mean((EU.y_hat_glm - test.set$EU_Sales)^2),
           Japan = mean((JP.y_hat_glm - test.set$JP_Sales)^2),
           Other.Countries = mean((Other.y_hat_glm - test.set$Other_Sales)^2))
```

# Conclusion

In this project, I utilize Machine Learning concepts of GLM and Random Forest to generate algorithms to predict sales by the following predictors: Genres, Publisher Rank, Platforms, and Released Year in North America, Europe, Japan, and Other Countries. The RMSE I acquired with my algorithms are lower than .15 in all countries, except America.

Some limitations with my algorithms lie in the assumptions I made about the dataset. With this method, I did not factor in population differences between the countries. It is possible that Japan has lower sales in video games comparing to other countries can be due to massive difference in population size. Another potential factor that can influence video games sales would be access to the market. Some consoles were established in Japan first while others may first be populated in Western countries.

As such, it is highly recommended that future algorithm developers take into account these geographic and demographic differences into the dataset so that a more thorough approach can be achieved.

# References

(2016). Video Game Sales Dataset (Version 2). Kaggle. Retrieved May 1st, 2023 from <https://www.kaggle.com/datasets/gregorut/videogamesales>

Irizarry, R. (n.d.). \*Introduction to data science\*. rafalab. Retrieved April 29, 2023, from <https://rafalab.github.io/dsbook/>
